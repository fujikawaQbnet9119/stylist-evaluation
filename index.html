<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>スタイリスト評価フォーム</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- 基本情報入力ページ -->
    <div id="basicInfoPage" class="container">
        <h1>基本情報の入力</h1>
        <form id="basicInfoForm">
            <div class="form-group">
                <label for="blockName">ブロック名:</label>
                <input type="text" id="blockName" name="blockName" required>
            </div>
            <div class="form-group">
                <label for="storeName">店舗名:</label>
                <input type="text" id="storeName" name="storeName" required>
            </div>
            <div class="form-group">
                <label for="employeeId">社員番号:</label>
                <input type="text" id="employeeId" name="employeeId" required>
            </div>
            <div class="form-group">
                <label for="employeeName">氏名:</label>
                <input type="text" id="employeeName" name="employeeName" required>
            </div>
            <div class="form-group">
                <label for="currentSalary">現在の基本給 (円):</label>
                <input type="number" id="currentSalary" name="currentSalary" required>
            </div>
            <button type="button" id="proceedToEvaluation">評価入力に進む</button>
        </form>
    </div>

    <!-- 評価入力ページ -->
    <div id="evaluationPage" class="container hidden">
        <h1>スタイリスト評価入力</h1>
        <form id="evaluationForm">
            <table>
                <thead>
                    <tr>
                        <th>No</th>
                        <th>評価項目</th>
                        <th>評価内容</th>
                        <th>評価点</th>
                    </tr>
                </thead>
                <tbody id="evaluationTable">
                    <!-- JavaScriptで動的に項目を生成 -->
                </tbody>
            </table>
            <div class="additional-input">
                <label for="monthlyCuts">最新月の月間カット人数:</label>
                <input type="number" id="monthlyCuts" name="monthlyCuts" min="0" value="0">
            </div>
            <button type="button" id="backToBasicInfo">前に戻る</button>
            <button type="button" id="calculateBtn">評価結果を確認</button>
        </form>
    </div>

    <!-- 評価結果ページ -->
    <div id="resultPage" class="container hidden">
        <h1>評価結果</h1>
        <div class="card">
            <div class="card-section">
                <h2>基本情報</h2>
                <p>ブロック名: <span id="blockNameDisplay"></span></p>
                <p>店舗名: <span id="storeNameDisplay"></span></p>
                <p>社員番号: <span id="employeeIdDisplay"></span></p>
                <p>氏名: <span id="employeeNameDisplay"></span></p>
                <p>現在の基本給: <span id="currentSalaryDisplay"></span> 円</p>
            </div>
            <div class="card-section">
                <h2>評価結果</h2>
                <p>合計点: <span id="totalScore"></span></p>
                <p>評価ランク: <span id="rank"></span></p>
                <p>適正基本給: <span id="salaryCap"></span> 円</p>
                <p>最新月の月間カット人数: <span id="monthlyCutsDisplay"></span> 人 / 年間カット人数: <span id="annualCutsDisplay"></span> 人 (点数: <span id="cutScoreDisplay"></span>)</p>
            </div>
        </div>
        <button type="button" id="backToEvaluation">前に戻る</button>
        <button type="button" id="restartBtn">最初に戻る</button>
        <button type="button" id="exportBtn">Excelで出力</button>
    </div>

    <script src="script.js"></script>
</body>
</html>
